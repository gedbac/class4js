var class4js=(function(global){"use strict";var exports={};var TypeException=function(message){this.__name="TypeException";this.__message=message;};TypeException.prototype=Object.create(Object.prototype,{name:{get:function(){return this.__name;},enumerable:true,configurable:false},message:{get:function(){return this.__message;},enumerable:true,configurable:false},toString:function(){return this.name+": "+this.message;}});Object.seal(TypeException);Object.seal(TypeException.prototype);exports.TypeException=TypeException;var Namespace=Object.create(null,{create:{value:function(name){if(name){var fragments=name.split("."),parent=global;for(var i=0;i<fragments.length;i++){if(!(fragments[i] in parent)){parent[fragments[i]]={};}parent=parent[fragments[i]];}}else{throw new TypeException("Namespace is not set");}},writable:false,enumerable:true,configurable:false}});Object.freeze(Namespace);global.$namespace=Namespace.create;exports.Namespace=Namespace;var TypeBuilder=Object.create(null,{isPrivate:{value:function(name){return/^__([A-Z]|[a-z]|[0-9])*$/g.test(name);},writable:false,enumerable:true,configurable:false},isProtected:{value:function(name){return/^_([A-Z]|[a-z]|[0-9])*$/g.test(name);},writable:false,enumerable:true,configurable:false},isPublic:{value:function(name){return !TypeBuilder.isPrivate(name)&&!TypeBuilder.isProtected(name);},writable:false,enumerable:true,configurable:false},isValidTypeName:{value:function(name){return/^[A-Z]([A-Z]|[a-z]|[0-9])*$/g.test(name);},writable:false,enumerable:true,configurable:false},isValidConstructorName:{value:function(name){return name=="__construct__";},writable:false,enumerable:true,configurable:false},isValidName:{value:function(name){return/^(_|__|[a-z])([a-z]|[A-Z]|[0-9])*$/g.test(name);},writable:false,enumerable:true,configurable:false},isValidConstantName:{value:function(name){return/^([A-Z]|[0-9]|_)*$/g.test(name);},writable:false,enumerable:true,configurable:false},isObjectInitializer:{value:function(param){if(typeof param==="object"&&Object.getPrototypeOf(param)===Object.prototype){return true;}return false;}},addConstructor:{value:function(owner,name,value){if(owner){if(TypeBuilder.isValidConstructorName(name)){Object.defineProperty(owner,name,{value:value,writable:false,enumerable:false,configurable:false});}else{throw new TypeException("Constructor's name is invalid: '"+name+"'");}}else{throw new TypeException("Constructor's '"+name+"' owner can't be null");}},writable:false,enumerable:true,configurable:false},addField:{value:function(owner,name,value){if(owner){if(TypeBuilder.isValidName(name)){Object.defineProperty(owner,name,{value:value,writable:true,enumerable:TypeBuilder.isPublic(name),configurable:false});}else{throw new TypeException("Field's '"+name+"' name is invalid");}}else{throw new TypeException("Field's '"+name+"' owner can't be null");}},writable:false,enumerable:true,configurable:false},addMethod:{value:function(owner,name,value){if(owner){if(TypeBuilder.isValidName(name)){Object.defineProperty(owner,name,{value:value,writable:false,enumerable:TypeBuilder.isPublic(name),configurable:false});}else{throw new TypeException("Method's name is invalid: '"+name+"'");}}else{throw new TypeException("Method's '"+name+"' owner can't be null");}},writable:false,enumerable:true,configurable:false},addProperty:{value:function(owner,name,getter,setter){if(owner){if(TypeBuilder.isValidName(name)){Object.defineProperty(owner,name,{get:getter,set:setter,enumerable:TypeBuilder.isPublic(name),configurable:false});}else{throw new TypeException("Property's name is invalid: '"+name+"'");}}else{throw new TypeException("Property's '"+name+"' owner can't be null");}},writable:false,enumerable:true,configurable:false},addConstant:{value:function(owner,name,value){if(owner){if(TypeBuilder.isValidConstantName(name)){Object.defineProperty(owner,name,{get:function(){return value;},enumerable:TypeBuilder.isPublic(name),configurable:false});}else{throw new TypeException("Constant's name is invalid: '"+name+"'");}}else{throw new TypeException("Constant's '"+name+"' owner can't be null");}},writable:false,enumerable:true,configurable:false},addStatic:{value:function(owner,properties){TypeBuilder.forEach(properties,function(name,value){if(TypeBuilder.isMethod(value)){TypeBuilder.addMethod(owner,name,value);}else{if(TypeBuilder.isProperty(value)){TypeBuilder.addProperty(owner,name,value["get"],value["set"]);}else{if(TypeBuilder.isConstant(name)){TypeBuilder.addConstant(owner,name,value);}else{TypeBuilder.addField(owner,name,value);}}}});},writable:false,enumerable:false,configurable:false},isConstructor:{value:function(name){return name=="__construct__";},writable:false,enumerable:true,configurable:false},isMethod:{value:function(value){return typeof value==="function";},writable:false,enumerable:true,configurable:false},isProperty:{value:function(value){return(value["get"]!=null||value["set"]!=null);},writable:false,enumerable:true,configurable:false},isConstant:{value:function(name){return/^([A-Z]|[0-9]|_)*$/g.test(name);},writable:false,enumerable:true,configurable:false},isStatic:{value:function(name){return name=="__static__";},writable:false,enumerable:false,configurable:false},isField:{value:function(name,value){return !TypeBuilder.isConstructor(name)&&!TypeBuilder.isMethod(value)&&!TypeBuilder.isProperty(value)&&!TypeBuilder.isConstant(name)&&!TypeBuilder.isStatic(name);},writable:false,enumerable:true,configurable:false},forEach:{value:function(properties,callback){if(properties){if(typeof callback==="function"){var names=Object.keys(properties);for(var i=0;i<names.length;i++){callback(names[i],properties[names[i]]);}}else{throw new TypeException("Callback is not function");}}},writable:false,enumerable:true,configurable:false}});Object.seal(TypeBuilder);exports.TypeBuilder=TypeBuilder;var TypeExtension=function(target,name,value){this.__target=target;this.__name=name;this.__value=value;};TypeExtension.prototype=Object.create(Object.prototype,{target:{get:function(){return this.__target;},enumerable:true,configurable:false},name:{get:function(){return this.__name;},enumerable:true,configurable:false},value:{get:function(){return this.__value;},enumerable:true,configurable:false}});Object.seal(TypeExtension);Object.seal(TypeExtension.prototype);var Class=Object.create(null,{__extensions:{value:[],writable:true,enumerable:false,configurable:false},__initialize:{value:function(prototype,args){if(prototype&&prototype.hasOwnProperty("__construct__")){if(typeof prototype["__construct__"]==="function"){if(args&&args.length==1&&TypeBuilder.isObjectInitializer(args[0])){prototype["__construct__"].apply(this);ObjectFactory.initialize(this,args[0]);}else{prototype["__construct__"].apply(this,args);}}}},writable:false,enumerable:false,configurable:false},__descriptorsAreEqual:{value:function(property,source,target){for(var propertyName in target){if(propertyName!="writable"&&propertyName!="enumerable"&&propertyName!="configurable"){if(!(propertyName in source)||typeof target[propertyName]!==typeof source[propertyName]){throw new TypeException("Implementation of the property '"+propertyName+"' is invalid");}}}},writable:false,enumerable:false,configurable:false},__getPropertyDescriptor:{value:function(object,propertyName){var descriptor=Object.getOwnPropertyDescriptor(object,propertyName);if(!descriptor){return Class.__getPropertyDescriptor(Object.getPrototypeOf(object),propertyName);}return descriptor;},writable:false,enumerable:false,configurable:false},__instanceOf:{value:function(source,target){if(source&&target){for(var propertyName in target){if(!(propertyName in source)){throw new TypeException("Class doesn't implemet property: "+propertyName);}else{var sourceDescriptor=Class.__getPropertyDescriptor(source,propertyName);var targetDescriptor=Class.__getPropertyDescriptor(target,propertyName);Class.__descriptorsAreEqual(propertyName,sourceDescriptor,targetDescriptor);}}return true;}else{throw new TypeException("Source or target is not set");}},writable:false,enumerable:false,configurable:false},create:{value:function(properties,parent,interfaces){var constructor=function(){Class.__extend(this);if(parent){Class.__initialize.call(this,parent.prototype,arguments);}Class.__initialize.call(this,Object.getPrototypeOf(this),arguments);Object.seal(this);};if(parent){constructor.prototype=Object.create(parent.prototype);Object.defineProperty(constructor.prototype,"_super",{get:function(){var prototype=Object.getPrototypeOf(this);return Object.getPrototypeOf(prototype);},enumerable:false,configurable:false});}else{constructor.prototype=Object.create(Object.prototype);}TypeBuilder.forEach(properties,function(name,value){if(TypeBuilder.isConstructor(name)){TypeBuilder.addConstructor(constructor.prototype,name,value);}else{if(TypeBuilder.isMethod(value)){TypeBuilder.addMethod(constructor.prototype,name,value);}else{if(TypeBuilder.isProperty(value)){TypeBuilder.addProperty(constructor.prototype,name,value["get"],value["set"]);}else{if(TypeBuilder.isConstant(name)){TypeBuilder.addConstant(constructor,name,value);}else{if(TypeBuilder.isStatic(name)){TypeBuilder.addStatic(constructor,value);}else{TypeBuilder.addField(constructor.prototype,name,value);}}}}}});Object.seal(constructor);Object.seal(constructor.prototype);if(interfaces){if(interfaces instanceof Array){for(var i=0;i<interfaces.length;i++){Class.__instanceOf(constructor.prototype,interfaces[i]);}}else{Class.__instanceOf(constructor.prototype,interfaces);}}return constructor;},writable:false,enumerable:true,configurable:false},__extend:{value:function(instance){if(Class.__extensions&&Class.__extensions.length>0){for(var i=0;i<Class.__extensions.length;i++){var extension=Class.__extensions[i];if(Interface.instanceOf(instance,extension.target)){if(!(extension.name in instance)){TypeBuilder.addMethod(instance,extension.name,extension.value);}}}}},writable:false,enumerable:true,configurable:false},addExtension:{value:function(target,name,value){if(!target){throw new TypeException("Target is not set");}if(!name){throw new TypeException("Method name is not set");}if(!TypeBuilder.isPublic(name)){throw new TypeException("Only public methods can be added");}if(!value||!TypeBuilder.isMethod(value)){throw new TypeException("Method is not set");}if(!TypeBuilder.isMethod(value)){throw new TypeException("Method is invalid");}Class.__extensions.push(new TypeExtension(target,name,value));},writable:false,enumerable:true,configurable:false}});Object.freeze(Class);global.$class=Class.create;global.$extend=Class.addExtension;exports.Class=Class;var Interface=Object.create(null,{__copyParentMembers:{value:function(target,source){if(source){for(var propertyName in source){var property=Object.getOwnPropertyDescriptor(source,propertyName);if(property["value"]&&TypeBuilder.isMethod(property["value"])){TypeBuilder.addMethod(target,propertyName,property.value);}else{if(TypeBuilder.isProperty(property)){TypeBuilder.addProperty(target,propertyName,property.get,property.set);}else{throw new TypeException("Member '"+propertyName+"' is invalid");}}}}},writable:false,enumerable:true,configurable:false},create:{value:function(properties,parents){var obj={};if(parents){if(parents instanceof Array){for(var i=0;i<parents.length;i++){Interface.__copyParentMembers(obj,parents[i]);}}else{Interface.__copyParentMembers(obj,parents);}}TypeBuilder.forEach(properties,function(name,value){if(TypeBuilder.isMethod(value)){TypeBuilder.addMethod(obj,name,value);}else{if(TypeBuilder.isProperty(value)){TypeBuilder.addProperty(obj,name,value["get"],value["set"]);}else{throw new TypeException("Member '"+name+"' is invalid");}}});Object.freeze(obj);return obj;},writable:false,enumerable:true,configurable:false},instanceOf:{value:function(source,target){if(source&&target){if(typeof target==="object"){for(var propertyName in target){if(!(propertyName in source)){return false;}}}else{if(!(source instanceof target)){return false;}}return true;}else{throw new TypeException("Source or target is not set");}},writable:false,enumerable:true,configurable:false}});Object.freeze(Interface);global.$interface=Interface.create;global.$is=Interface.instanceOf;exports.Interface=Interface;var ObjectFactory=Object.create(null,{create:{value:function(type,properties){if(type){if(properties instanceof type){return properties;}else{var object=new type();ObjectFactory.initialize(object,properties);return object;}}else{throw new TypeException("Type is not set.");}},writable:false,enumerable:true,configurable:false},initialize:{value:function(target,source){if(target&&source){for(var propertyName in source){if(propertyName in target){target[propertyName]=source[propertyName];}else{throw new TypeException("Target doesn't contains a property '"+propertyName+"'");}}}}}});Object.seal(ObjectFactory);global.$create=ObjectFactory.create;global.$init=ObjectFactory.initialize;exports.ObjectFactory=ObjectFactory;var Module=Object.create(null,{create:{value:function(scope,args){var module={};if(scope){if(args){if(!(args instanceof Array)){throw new TypeException("Type of parameter 'args' is invalid");}args.splice(0,0,module);scope.apply(this,args);}else{scope(module);}}return module;},writable:false,enumerable:true,configurable:false}});Object.freeze(Module);global.$module=Module.create;exports.Module=Module;var Enum=Object.create(null,{create:{value:function(fields){var obj={};TypeBuilder.forEach(fields,function(name,value){Enum.__addField(obj,name,value);});Object.freeze(obj);return obj;},writable:false,enumerable:true,configurable:false},__isValidName:{value:function(name){return/^([a-z])([a-z]|[A-Z]|[0-9])*$/g.test(name);},writable:false,enumerable:false,configurable:false},__addField:{value:function(owner,name,value){if(owner){if(Enum.__isValidName(name)){if(typeof value==="number"){Object.defineProperty(owner,name,{value:value,writable:false,enumerable:true,configurable:false});}else{throw new TypeException("Field's '"+name+"' value is invalid");}}else{throw new TypeException("Field's '"+name+"' name is invalid");}}else{throw new TypeException("Field's '"+name+"' owner can't be null");}},writable:false,enumerable:false,configurable:false}});Object.freeze(Enum);global.$enum=Enum.create;exports.Enum=Enum;return exports;}(window));